<section class="container section__login">
    <h1 class="section__login-h1">Create Your Account</h1>
    <form [formGroup]="registrationForm" class="row">
        <div class="col-lg-6 col-md-6 col-xl-6 col-12 col-sm-12">
            <div class="md-form">
                <input mdbInput mdbValidate type="text" id="form1" class="form-control input-field__input"
                    formControlName="name" appRegistrationAutoFocus autocomplete="off">
                <label for="form1"> Name </label>

                <div class="registration-form__icons">
                    <mdb-icon [@bird] fas icon="check" class="green-text"
                        *ngIf="registrationForm.get('name').valid && registrationForm.get('name').dirty">
                    </mdb-icon>
                    <mdb-icon [@cancel] fas icon="times" class="red-text" *ngIf="registrationForm.get('name').invalid && registrationForm.get('name').dirty ||
                        registrationForm.get('name').invalid && registrationForm.get('name').touched">
                    </mdb-icon>
                </div>
                <div [@errors_wrapper] *ngIf="registrationForm.get('name').invalid && registrationForm.get('name').dirty
                    || registrationForm.get('name').invalid && registrationForm.get('name').touched">

                    <mdb-error [@errors] *ngIf="registrationForm.get('name').errors.required">
                        Required field
                    </mdb-error>
                </div>
            </div>
        </div>
        <div class="col-lg-6 col-md-6 col-xl-6 col-12 col-sm-12">
            <div class="md-form">
                <input mdbInput mdbValidate type="text" id="form2" class="form-control" formControlName="surname"
                    autocomplete="off">
                <label for="form2">
                    Surname
                </label>
                <div class="registration-form__icons">
                    <mdb-icon [@bird] fas icon="check" class="green-text"
                        *ngIf="registrationForm.get('surname').valid && registrationForm.get('surname').dirty">
                    </mdb-icon>
                    <mdb-icon [@cancel] fas icon="times" class="red-text" *ngIf="registrationForm.get('surname').invalid && registrationForm.get('surname').dirty ||
                    registrationForm.get('surname').invalid && registrationForm.get('surname').touched">
                    </mdb-icon>
                </div>
                <div [@errors_wrapper] *ngIf="registrationForm.get('surname').invalid && registrationForm.get('surname').dirty
                || registrationForm.get('surname').invalid && registrationForm.get('surname').touched">
                    <mdb-error [@errors] *ngIf="registrationForm.get('surname').errors.required">
                        Required field
                    </mdb-error>
                </div>
            </div>
        </div>
        <div class="col-lg-12 col-md-12 col-xl-12 col-12 col-sm-12">
            <div class="md-form">
                <input mdbInput mdbValidate type="text" id="form3" class="form-control" formControlName="email"
                    autocomplete="off">
                <label for="form3" class="">
                    Email
                </label>
                <div class="registration-form__icons">
                    <mdb-icon [@bird] fas icon="check" class="green-text"
                        *ngIf="registrationForm.get('email').valid && registrationForm.get('email').dirty"></mdb-icon>

                    <mdb-icon [@cancel] fas icon="times" class="red-text" *ngIf="registrationForm.get('email').invalid && registrationForm.get('email').dirty||
                    registrationForm.get('email').invalid && registrationForm.get('email').touched"></mdb-icon>

                    <div class="spinner-border text-light" *ngIf="registrationForm.get('email').status === 'PENDING'"
                        role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
                <div [@errors_wrapper] *ngIf="registrationForm.get('email').invalid && registrationForm.get('email').dirty
                || registrationForm.get('email').invalid && registrationForm.get('email').touched">
                    <mdb-error [@errors] *ngIf="registrationForm.get('email').errors.required">
                        Required field
                    </mdb-error>
                    <mdb-error [@errors] *ngIf="registrationForm.get('email').errors.uniqEmail">
                        Such mail already exists
                    </mdb-error>
                    <mdb-error [@errors] *ngIf="registrationForm.get('email').errors.email">
                        Incorrect input
                    </mdb-error>
                </div>
                <mdb-success *ngIf="registrationForm.get('email').status === 'VALID'">
                    Email is available!
                </mdb-success>
            </div>
        </div>
        <div class="col-lg-5 col-md-5 col-xl-5 col-10 col-sm-10">
            <div class="md-form">
                <input mdbInput mdbValidate type="password" #passwordInput id="form4" class="form-control"
                    formControlName="password" autocomplete="off">
                <label for="form4">
                    Password
                </label>
                <div class="registration-form__icons">
                    <mdb-icon [@bird] fas icon="check" class="green-text icon__margin"
                        *ngIf="registrationForm.get('password').valid && registrationForm.get('password').dirty">
                    </mdb-icon>

                    <mdb-icon [@cancel] fas icon="times" class="red-text icon__margin" *ngIf="registrationForm.get('password').invalid && registrationForm.get('password').dirty ||
                    registrationForm.get('password').invalid && registrationForm.get('password').touched"></mdb-icon>

                    <div class="spinner-border text-light" *ngIf="registrationForm.get('password').status === 'PENDING'"
                        role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
                <div *ngIf="registrationForm.get('password').invalid && registrationForm.get('password').dirty || registrationForm.get('password').invalid && registrationForm.get('password').touched">
                    <small [@errors] *ngIf="registrationForm.get('password').errors.required">
                        Required field
                    </small>
                    <small [@errors] *ngIf="registrationForm.get('password').errors.minlength">
                        Password must be at least 8 characters long
                    </small>
                </div>
                <!-- SHOULD REFACTORING THIS PART (RUDOLF) -->
                <div [@bird] *ngIf="registrationForm.get('password').valid && registrationForm.get('password').dirty"
                    class="login__password-protection">
                    <div class="password__difficulty">
                        <div *ngIf="difficulty === 'weak'" style="width: 30%; background-color: #f44336; height: 100%;">
                        </div>
                        <div *ngIf="difficulty === 'common'"
                            style="width: 50%; background-color: #ffc107; height: 100%;"></div>
                        <div *ngIf="difficulty === 'well'" style="width: 80%; background-color: #80ba29; height: 100%;">
                        </div>
                        <div *ngIf="difficulty === 'super'"
                            style="width: 100%; background-color: #00c851; height: 100%;"></div>
                    </div>
                    <span>Password protection level</span>
                </div>
            </div>
        </div>
        <div class="col-lg-1 col-md-1 col-xl-1 col-2 col-sm-2 registration-form__icons--block">
            <mdb-icon fas icon="eye" class="icon__animated" (click)="showHidePassword()"></mdb-icon>
        </div>
        <div class="col-lg-6 col-md-6 col-xl-6 col-12 col-sm-12">
            <div class="md-form">
                <input mdbInput type="password" id="form5" class="form-control"
                    [ngClass]="{protected_input: ( registrationForm.hasError('notSame') && registrationForm.get('confirmPassword').dirty ) ||
                    ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').dirty ) || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched ),
                    success_input: registrationForm.get('confirmPassword').valid && registrationForm.get('confirmPassword').dirty && !!registrationForm.errors === false}"
                    formControlName="confirmPassword" autocomplete="off">
                <label for="form5"
                    [ngClass]="{protected_label: ( registrationForm.hasError('notSame') && registrationForm.get('confirmPassword').dirty ) ||
                    ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').dirty) || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched ),
                success_label: registrationForm.get('confirmPassword').valid && registrationForm.get('confirmPassword').dirty && !!registrationForm.errors === false}">
                    Confirm Password
                </label>
                <div class="registration-form__icons">
                    <mdb-icon [@bird] fas icon="check" class="green-text"
                        [hidden]="registrationForm.hasError('notSame')"
                        *ngIf="registrationForm.get('confirmPassword').valid && registrationForm.get('confirmPassword').dirty">
                    </mdb-icon>
                    <mdb-icon [@cancel] fas icon="times" class="red-text"
                        *ngIf="(registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').dirty)  ||  registrationForm.get('confirmPassword').dirty && registrationForm.hasError('notSame') || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched )">
                    </mdb-icon>
                </div>
                <div class="registration__confirm-pass"
                    *ngIf="registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').dirty || registrationForm.hasError('notSame') || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched )">
                    <small [@errors]
                        *ngIf="registrationForm.get('confirmPassword').errors?.required && registrationForm.get('confirmPassword').dirty || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched )">
                        Required field
                    </small>
                    <small [@errors]
                        *ngIf="registrationForm.hasError('notSame') && registrationForm.get('confirmPassword').dirty || ( registrationForm.get('confirmPassword').invalid && registrationForm.get('confirmPassword').touched )">
                        Passwords do not match
                    </small>
                </div>
            </div>
        </div>
    </form>
    <div class="row registration__button">
        <div class="col-12  registration__button_block">
            <button (click)="SignUp()" lass="w-100" type="button" mdbBtn color="dark" mdbWavesEffect
                [disabled]="registrationForm.invalid || registrationForm.pending">
                Sign Up
            </button>
            <a routerLink="/login">Back to Login</a>
        </div>
    </div>
</section>
